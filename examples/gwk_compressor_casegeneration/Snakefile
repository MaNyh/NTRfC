from snakemake.utils import validate
import os

#todo move this snakepipe to according dir in sourcecode

configfile : "casesettings.yaml"
validate(config,"config.schema.yaml")
basedir = workflow.current_basedir

rule all:
    input:
        "done.txt"

rule copy_template:
    output:
        #todo: is there a readable dataformat alternative (csv) instead of pickle?
        #dynamic("01_case/{case_type}/{case_files}"),
        dynamic("01_case/{level_1}/{level_2}"),
        "01_case/check.txt"
    params:
        case_type = config["case_params"]["case_type"],
        case_parameters = config["case_params"]["parameters"]
    run:
        from case_creation import create_case_fromtemplate
        create_case_fromtemplate(params["case_type"],params["case_parameters"],os.path.join(basedir,"01_case"))



rule check_template:
    input:
        #dynamic("01_case/{case_type}/{case_files}")
        dynamic("01_case/{level_1}/{level_2}")
    output:
        "done.txt"
    run:
        print("tbd")
